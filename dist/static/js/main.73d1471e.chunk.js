(this["webpackJsonphpx-extension"]=this["webpackJsonphpx-extension"]||[]).push([[0],{11:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},12:function(e,t,n){"use strict";var r=n(3),a=n(1),c=n.n(a),s=n(2),o=n(0),i=n.n(o),u=n(9),l=n.n(u),d="undefined"!==typeof window&&"#popup"===window.location.hash,b="undefined"!==typeof window&&"#background"===window.location.hash,f={popup:void 0,background:void 0},p={connected:!1,session:"",server:"",popup_connected:!1},m=n(10),v=fetch;function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={credentials:"include",method:"post"};(t.json||"object"===typeof t.body)&&(n.headers=Object.assign(n.headers||{},t.headers||{},{Accept:"application/json","Content-Type":"application/json"}),"string"!==typeof t.body&&(t.body=JSON.stringify(t.body))),delete t.json;var r=Object.assign(n,t);return v(e,r)},g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.session,a=void 0===r?void 0:r,o=n.server,i=void 0===o?void 0:o,u={session:a||p.session,name:"hpx-browser-extension",data:[w({fname:e},t)]};return h(i||p.server,{method:"post",json:!0,body:u}).then(function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=5;break}return e.next=3,t.json();case 3:!(r=e.sent).error&&r.data?(n=r.data,Array.isArray(n)&&(n=n[0])):console.log(r);case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},k=function(){var e=Object(s.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("add_urls_to_download_queue",{urls:t});case 2:if((n=e.sent).error){e.next=8;break}if(!n.data){e.next=6;break}return e.abrupt("return",!0);case 6:e.next=9;break;case 8:throw Error(n.error);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(e){return i.a.createElement("div",{className:"ui error message"},e.children)},j=i.a.createContext({server:p.server,session:p.session,connected:!1,onConnect:function(e,t){},setError:function(e){}}),y=function(){var e=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!browser){e.next=4;break}return e.next=3,browser.permissions.contains({origins:[t]});case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!browser){e.next=4;break}return e.next=3,browser.permissions.contains({permissions:t});case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E(["webNavigation"]));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=n;case 5:if(!e.t0){e.next=8;break}return browser.contentScripts.register({matches:[t],js:[{code:n}]}),e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="string"===typeof t,!browser){e.next=6;break}return e.next=4,browser.storage.local.get(t);case 4:return r=e.sent,e.abrupt("return",n?r[t]:r);case 6:return e.abrupt("return",n?void 0:{});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!browser){e.next=4;break}return e.next=3,browser.storage.local.clear();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!browser){e.next=4;break}return e.next=3,browser.storage.local.set(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!browser){e.next=6;break}return e.next=3,browser.tabs.query({currentWindow:!0,active:!0});case 3:return t=e.sent,n=t[0],e.abrupt("return",n?n.url:"");case 6:return e.abrupt("return","");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!browser){e.next=6;break}return e.next=3,browser.tabs.query({currentWindow:!0,active:!0});case 3:return t=e.sent,n=t[0],e.abrupt("return",n?n.id:void 0);case 6:return e.abrupt("return",void 0);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,r,a,s,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},n=t.text,r=void 0===n||n,a=t.activeTab,s=void 0===a||a,!r){e.next=17;break}if(e.t1=browser.browserAction,!s){e.next=9;break}return e.next=6,D();case 6:e.t2=e.sent,e.next=10;break;case 9:e.t2=void 0;case 10:return e.t3=e.t2,e.t4={tabId:e.t3},e.next=14,e.t1.getBadgeText.call(e.t1,e.t4);case 14:e.t0=e.sent,e.next=18;break;case 17:e.t0=void 0;case 18:return e.t5=e.t0,e.abrupt("return",{text:e.t5});case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,r,a,s,o,i,u,l,d=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:{},n=t.text,r=void 0===n?void 0:n,a=t.color,s=void 0===a?void 0:a,o=t.background,i=void 0===o?void 0:o,u=t.activeTab,l=void 0===u||u,e.t0=browser.browserAction,e.t1=i||"white",!l){e.next=9;break}return e.next=6,D();case 6:e.t2=e.sent,e.next=10;break;case 9:e.t2=void 0;case 10:if(e.t3=e.t2,e.t4={color:e.t1,tabId:e.t3},e.t0.setBadgeBackgroundColor.call(e.t0,e.t4),e.t5=browser.browserAction,e.t6=s||"black",!l){e.next=21;break}return e.next=18,D();case 18:e.t7=e.sent,e.next=22;break;case 21:e.t7=void 0;case 22:if(e.t8=e.t7,e.t9={color:e.t6,tabId:e.t8},e.t5.setBadgeTextColor.call(e.t5,e.t9),void 0===r){e.next=38;break}if(e.t10=browser.browserAction,e.t11=r,!l){e.next=34;break}return e.next=31,D();case 31:e.t12=e.sent,e.next=35;break;case 34:e.t12=void 0;case 35:e.t13=e.t12,e.t14={text:e.t11,tabId:e.t13},e.t10.setBadgeText.call(e.t10,e.t14);case 38:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(o.useContext)(j),t=Object(o.useState)(!1),n=Object(r.a)(t,2),a=n[0],u=n[1],l=Object(o.useState)(""),d=Object(r.a)(l,2),b=d[0],f=d[1],p=Object(o.useState)(""),m=Object(r.a)(p,2),v=m[0],x=m[1],w=Object(o.useState)(""),g=Object(r.a)(w,2),k=g[0],y=g[1],E=Object(o.useState)(""),N=Object(r.a)(E,2),S=N[0],_=N[1],A=function(e){return f("Failed to connect to server (".concat(e.status,"): ").concat(e.statusText))},D=function(t,n,r){var a=t+"/server/";h(a,{method:"head"}).then(function(){var o=Object(s.a)(c.a.mark((function s(o){var i,l;return c.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!o.ok){c.next=15;break}return c.next=3,h(a,{method:"post",body:{username:n,password:r}});case 3:if(i=c.sent,u(!1),!i.ok){c.next=12;break}return c.next=8,i.json();case 8:(l=c.sent).error?l.code&&411===l.code?f("Wrong credentials"):f(l.error):"Authenticated"===l.data?(P({server:t,username:n,password:r}),e.onConnect(!0,{server:a,username:n,password:r,session:l.session})):f("Received a weird response: ".concat(JSON.stringify(l))),c.next=13;break;case 12:404===i.status?f("The server might have disabled the communication endpoint (enable it in HPX config with server.enable_http_endpoint)"):A(i);case 13:c.next=17;break;case 15:A(o),u(!1);case 17:case"end":return c.stop()}}),s)})));return function(e){return o.apply(this,arguments)}}()).catch((function(e){u(!1),f("An error occured: ".concat(e.message))}))};return Object(o.useEffect)((function(){Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(["username","password","server"]);case 2:(t=e.sent).server&&t.username&&D(t.server,t.username,t.password),_(t.server),x(t.username),y(t.password);case 7:case"end":return e.stop()}}),e)})))()}),[]),i.a.createElement("form",{id:"connect-form",className:"ui form ".concat(b?"error":""),onSubmit:function(e){e.preventDefault(),f(""),u(!0);var t=new FormData(e.target),n=t.get("server");n||(n="http://localhost:7008"),n.endsWith("/")&&(n=n.slice(0,-1));var r=t.get("username")||"default",a=t.get("password");D(n,r,a)}},i.a.createElement("div",{className:"field"},i.a.createElement("label",null,"HPX Web Server Host"),i.a.createElement("div",{className:"ui input"},i.a.createElement("input",{placeholder:"http://localhost:7008",defaultValue:S,type:"text",name:"server"}))),i.a.createElement("div",{className:"field"},i.a.createElement("label",null,"Username"),i.a.createElement("div",{className:"ui input"},i.a.createElement("input",{placeholder:"default",type:"text",defaultValue:v,name:"username"}))),i.a.createElement("div",{className:"field"},i.a.createElement("label",null,"Password"),i.a.createElement("div",{className:"ui input"},i.a.createElement("input",{placeholder:"",type:"password",defaultValue:k,name:"password"}))),!!b&&i.a.createElement(O,null,b),i.a.createElement("p",null,i.a.createElement("button",{type:"submit",className:"ui basic button right floated ".concat(a?" loading":"")},"Connect")))},U=n(13),$={"*://e-hentai.org/*":{code:n(7).default,test:".*//(www\\.)?e-hentai\\.org/.*$",gallery:".*//(www\\.)?e-hentai\\.org/g/[0-9]{3,10}/[0-9a-zA-Z]{3,15}/?$"},"*://exhentai.org/*":{code:n(7).default,test:".*//(www\\.)?exhentai\\.org/.*$",gallery:".*//(www\\.)?exhentai\\.org/g/[0-9]{3,10}/[0-9a-zA-Z]{3,15}/?$"},"*://panda.chaika.moe/*":{code:"",test:".*//(www\\.)?panda\\.chaika\\.moe/.*$",gallery:".*//(www\\.)?panda\\.chaika\\.moe/(gallery|archive)/[0-9]{3,15}/?$"},"*://nhentai.net/*":{code:"",test:".*//(www\\.)?nhentai\\.net/.*$",gallery:".*//(www\\.)?nhentai\\.net/g/[0-9]{3,10}/?$"}},B=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:t=e.sent,n="",e.t0=c.a.keys($);case 5:if((e.t1=e.t0()).done){e.next=14;break}if(r=e.t1.value,!$[r].gallery){e.next=12;break}if(!new RegExp($[r].gallery).test(t)){e.next=12;break}return n=t,e.abrupt("break",14);case 12:e.next=5;break;case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(e){var t=e.added,n=void 0!==t&&t,r=e.loading,a=void 0!==r&&r,c=e.children,s=void 0===c?void 0:c,o=Object(U.a)(e,["added","loading","children"]);return i.a.createElement("button",Object.assign({},o,{className:"ui basic button ".concat(s?"":"icon"," ").concat(n?"green":"primary"," ").concat(a?"loading":"")}),i.a.createElement("i",{className:"icon ".concat(n?"check":"download")}),s)},R=function(){var e=Object(o.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],u=Object(o.useState)(!1),l=Object(r.a)(u,2),d=l[0],b=l[1];return i.a.createElement(I,{added:n,loading:d,onClick:function(){var e=Object(s.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,B();case 3:(n=e.sent)&&(b(!0),k([n]).then((function(e){b(!1),a(e)})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},n?"Sent!":"Download this gallery")},W=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),n=t[0],a=t[1],u=Object(o.useState)(""),l=Object(r.a)(u,2),d=l[0],b=l[1],f=Object(o.useState)(!1),p=Object(r.a)(f,2),m=p[0],v=p[1],x=Object(o.useState)(!1),w=Object(r.a)(x,2),h=w[0],g=w[1];return Object(o.useEffect)((function(){Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=6;break}return e.t0=a,e.next=4,A();case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})))()}),[]),i.a.createElement("form",{className:"ui form",onSubmit:function(e){e.preventDefault(),v(!1),n&&(g(!0),k([n]).then((function(e){g(!1),e&&(a(""),v(!0))})).catch((function(e){g(!1),b(e.message)})))}},i.a.createElement("div",{className:"field"},i.a.createElement("div",{className:"ui action input"},i.a.createElement("input",{value:n,onChange:function(e){e.preventDefault(),a(e.target.value)},type:"text",placeholder:"URL"}),i.a.createElement(I,{type:"submit",added:m,loading:h}))),i.a.createElement("p",{className:"text-center"},d))},F=(n(39),function(){var e=Object(o.useContext)(j);return i.a.createElement("button",{className:"ui button mini icon",onClick:function(t){t.preventDefault(),e.onConnect(!1),P({username:"",password:""})}},i.a.createElement("i",{className:"sign-out flipped icon"}))}),q=function(){var e=Object.keys($).join(" | ");return i.a.createElement("div",{className:"ui label","data-tooltip":e,"data-position":"top left"},i.a.createElement("i",{className:"globe icon"}),"Sites")},H=function(){var e=Object(o.useContext)(j);return i.a.createElement("div",{className:"ui segment secondary"},e.connected&&i.a.createElement(F,null),i.a.createElement(q,null),i.a.createElement("a",{className:"ui label",href:"https://github.com/happypandax/extension/issues"},i.a.createElement("i",{className:"bug icon"})," Find an issue?"),i.a.createElement("a",{className:"ui label basic float-right",href:"https://github.com/happypandax/extension"},i.a.createElement("i",{className:"code icon"})," Source"),i.a.createElement("a",{className:"ui label basic teal float-right",href:"https://github.com/happypandax/happypandax"},i.a.createElement("i",{className:"github icon"})," HappyPanda X"))},J=function(){Object(o.useContext)(j);return i.a.createElement("div",{className:"ui segment tertiary"},i.a.createElement("button",{className:"ui button basic mini",onClick:_},"Clear storage"))},z=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,a=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,g("gallery_exists",{url:t});case 3:if((r=e.sent).error){e.next=21;break}if(!0!==r.data){e.next=9;break}return e.abrupt("return",!0);case 9:if(!1!==r.data){e.next=21;break}if(!n){e.next=21;break}if(!t.includes("e-hentai.org/g/")){e.next=17;break}return e.next=14,z(t.replace("e-hentai.org/g/","exhentai.org/g/"),!1);case 14:return e.abrupt("return",e.sent);case 17:if(!t.includes("exhentai.org/g/")){e.next=21;break}return e.next=20,z(t.replace("exhentai.org/g/","e-hentai.org/g/"),!1);case 20:return e.abrupt("return",e.sent);case 21:return e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(o.useState)(void 0),t=Object(r.a)(e,2),n=t[0],a=t[1],u=Object(o.useState)(!1),l=Object(r.a)(u,2),d=l[0],b=l[1],f=function(){var e=Object(s.a)(c.a.mark((function e(t,n){var r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),e.t0=n,e.t0){e.next=6;break}return e.next=5,B();case 5:e.t0=e.sent;case 6:if(!(r=e.t0)){e.next=15;break}return b(!0),e.next=11,z(r);case 11:s=e.sent,a(s),b(!1),K();case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){B().then((function(e){e&&f(null,e)}))}),[]),i.a.createElement("button",{className:"ui basic button ".concat(d?"loading":""," ").concat(!0===n?"green":!1===n?"red":"teal"),onClick:function(e){return f(e,void 0)}},i.a.createElement("i",{className:"icon ".concat(!0===n?"thumbs up":!1===n?"close":"question")}),!0===n?"Gallery already exists":!1===n?"Gallery does not exist":"Check if this gallery exists")},X=function(){return i.a.createElement("div",{className:"ui placeholder segment not-available"},i.a.createElement("div",{className:"ui icon header muted"},i.a.createElement("i",{className:"dont icon"}),"Not available"))},G=function(){var e=Object(o.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(o.useEffect)((function(){B().then((function(e){return a(!!e)}))}),[]),i.a.createElement(i.a.Fragment,null,n&&i.a.createElement("div",{id:"buttons",className:"ui basic segment secondary fluid"},i.a.createElement("div",{className:"two ui buttons"},i.a.createElement(R,null),i.a.createElement(V,null))),!n&&i.a.createElement(X,null))},Z=function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=c.a.keys($);case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,S(t,$[t].code);case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:if(!(t=e.sent)){e.next=13;break}return e.next=6,z(t);case 6:if(!e.sent){e.next=11;break}return e.next=9,T({text:"\u2714",color:"green",background:""});case 9:e.next=13;break;case 11:return e.next=13,T({text:"1",color:"",background:""});case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(e,t){"happypandax-download-this-gallery"===e.menuItemId&&function(){var t=e.linkUrl||e.pageUrl;if(t)for(var n in $){var r=$[n];r._gallery||(r._gallery=new RegExp(r.gallery)),r._gallery.test(t)&&z(t).then((function(e){e?T({text:"E",color:"red",background:""}):(k([t]),T({text:"S",color:"green",background:""}))}))}}()},Y=function(){var e=Object(s.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C("visited_sites");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:if(e.t0.includes(t.test)){e.next=11;break}return e.next=9,T({text:"!",color:"red",background:""});case 9:e.next=14;break;case 11:if(!p.connected){e.next=14;break}return e.next=14,K();case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ee=function(e){e.setState&&Object.assign(p,e.setState)},te=function(e){e.setState&&Object.assign(p,e.setState)},ne=!1;t.a=function(){var e=Object(o.useState)(p.connected),t=Object(r.a)(e,2),n=t[0],a=t[1],u=Object(o.useState)(p.server),m=Object(r.a)(u,2),v=m[0],x=m[1],w=Object(o.useState)(p.session),h=Object(r.a)(w,2),k=h[0],y=h[1],E=Object(o.useState)(""),S=Object(r.a)(E,2),_=S[0],D=S[1],U=Object(o.useState)(""),B=Object(r.a)(U,2),I=B[0],R=B[1],F=Object(o.useState)(""),q=Object(r.a)(F,2),z=q[0],V=q[1],X=Object(o.useState)(!d),K=Object(r.a)(X,2),re=K[0],ae=K[1];Object(o.useEffect)((function(){browser&&(!n&&re?T({text:"Off",color:"black",background:"red"}):re&&L({text:!0}).then((function(e){"Off"===e.text&&T({text:"",color:"",background:""})})))}),[n,re]),Object(o.useEffect)((function(){Object(s.a)(c.a.mark((function e(){var t,n,r,s,o,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ne){e.next=54;break}if(ne=!0,!browser){e.next=54;break}if(!d){e.next=39;break}return browser.runtime.onConnect.addListener((function(e){"background"===e.name&&setTimeout((function(){y(p.session),a(p.connected),x(p.server),ae(!0)}),100)})),f.background=browser.runtime.connect({name:"popup"}),f.background.onMessage.addListener(ee),f.background.postMessage({setState:{popup_connected:!0}}),e.next=11,L();case 11:if(e.t0=e.sent.text,"!"!==e.t0){e.next=33;break}T({text:"",color:""}),e.t1=c.a.keys($);case 15:if((e.t2=e.t1()).done){e.next=32;break}return t=e.t2.value,e.t3=new RegExp($[t].test),e.next=20,A();case 20:if(e.t4=e.sent,!e.t3.test.call(e.t3,e.t4)){e.next=30;break}return e.next=24,C("visited_sites");case 24:if(e.t5=e.sent,e.t5){e.next=27;break}e.t5=[];case 27:(n=e.t5).push($[t].test),P({visited_sites:n});case 30:e.next=15;break;case 32:V("This site is supported!");case 33:return e.t6=["S","E"],e.next=36,L();case 36:if(e.t7=e.sent.text,!e.t6.includes.call(e.t6,e.t7)){e.next=39;break}T({text:"",color:""});case 39:if(!b){e.next=52;break}return r=function e(){browser.tabs.create({url:browser.runtime.getURL("index.html")}),browser.browserAction.onClicked.removeListener(e)},browser.browserAction.onClicked.addListener(r),browser.runtime.onConnect.addListener((function(e){"popup"===e.name&&(f.popup=e,e.onMessage.addListener(te),browser.runtime.connect({name:"background"}),setTimeout((function(){f.popup.postMessage({setState:p})}),50))})),e.next=45,Z();case 45:return browser.runtime.onUpdateAvailable.addListener((function(){browser&&browser.runtime.reload()})),e.next=48,N();case 48:if(!e.sent){e.next=51;break}for(s=function(){var e=i[o];browser.webNavigation.onDOMContentLoaded.addListener((function(t){return Y($[e],t)}),{url:[{urlMatches:$[e].test}]})},o=0,i=Object.keys($);o<i.length;o++)s();case 51:browser.menus.create({id:"happypandax-download-this-gallery",title:"Download this gallery",contexts:["bookmark","link","page","tab"],onclick:Q,documentUrlPatterns:Object.keys($),targetUrlPatterns:Object.keys($)},(function(){browser.runtime.lastError&&console.error("failed to create context menu: ".concat(browser.runtime.lastError))}));case 52:u=browser.runtime.getManifest(),D(u.version);case 54:e.next=60;break;case 56:e.prev=56,e.t8=e.catch(0),R(e.t8.message),b&&console.error(e.t8);case 60:case"end":return e.stop()}}),e,null,[[0,56]])})))()}),[]);return i.a.createElement(j.Provider,{value:{setError:R,server:v,session:k,onConnect:function(e,t){a(e),p.connected=e,d&&f.background.postMessage({setState:{connected:e}}),t&&(p.server=t.server||v,p.session=t.session||k,x(p.server),y(p.session),d&&f.background.postMessage({setState:{session:p.session,server:p.server}}),p.connected&&g("set_config",{cfg:{"download.skip_if_downloaded_before":!1}}))},connected:n}},i.a.createElement(i.a.Fragment,null,re&&i.a.createElement("div",{className:"ui segments browser-popup"},z&&i.a.createElement("div",{className:"ui mini basic label green"},z),_&&i.a.createElement("div",{className:"ui top right attached mini basic label"},_),i.a.createElement("div",{className:"ui segment clearing"},i.a.createElement("div",{className:"text-center"},i.a.createElement("img",{src:l.a,className:"hpx-logo ".concat(n?"small":""),alt:"logo"})),I&&i.a.createElement(O,null,I),!n&&i.a.createElement(M,null),n&&i.a.createElement("div",null,i.a.createElement(G,null),i.a.createElement("div",{className:"ui horizontal divider"},"Or download URL"),i.a.createElement(W,null))),i.a.createElement(H,null),i.a.createElement(J,null))))}},14:function(e,t,n){e.exports=n(15)},15:function(e,t,n){"use strict";n.r(t),function(e){var t=n(0),r=n.n(t),a=n(8),c=n.n(a),s=(n(37),n(12)),o=n(11);"undefined"===typeof!e.chrome&&(e.browser=n(21)),"undefined"===typeof e.browser&&(e.browser=null),c.a.render(r.a.createElement(s.a,null),document.getElementById("root")),o.a()}.call(this,n(16))},37:function(e,t,n){},39:function(e,t,n){},7:function(e,t,n){"use strict";n.r(t),t.default="\nconst main = () => {\n}\n\nmain()\n"},9:function(e,t,n){e.exports=n.p+"static/media/happypandax.2f9b3d92.svg"}},[[14,1,2]]]);
//# sourceMappingURL=main.73d1471e.chunk.js.map